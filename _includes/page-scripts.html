<script>
  const langButton = document.getElementById('lang-button');
  const langMenu = document.getElementById('lang-menu');
  const mobileLangButton = document.getElementById('mobile-lang-button');
  const mobileLangMenu = document.getElementById('mobile-lang-menu');
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  const closeMenuButton = document.getElementById('close-menu-button');

  function toggleMenu(menu, button) {
    if (!menu || !button) return;
    const isHidden = menu.classList.contains('hidden');
    const arrowSvg = button.querySelector('svg:last-of-type');

    if (isHidden) {
      menu.classList.remove('hidden');
      setTimeout(() => {
        menu.classList.remove('opacity-0', 'scale-95');
        menu.classList.add('opacity-100', 'scale-100');
        if (arrowSvg) arrowSvg.classList.add('rotate-180');
      }, 10);
    } else {
      menu.classList.remove('opacity-100', 'scale-100');
      menu.classList.add('opacity-0', 'scale-95');
      if (arrowSvg) arrowSvg.classList.remove('rotate-180');
      setTimeout(() => { menu.classList.add('hidden'); }, 300);
    }
  }

  function toggleMobileMenu() { if (mobileMenu) mobileMenu.classList.toggle('-translate-x-full'); }

  if (langButton) langButton.addEventListener('click', () => toggleMenu(langMenu, langButton));
  if (mobileLangButton) mobileLangButton.addEventListener('click', () => toggleMenu(mobileLangMenu, mobileLangButton));
  if (mobileMenuButton) mobileMenuButton.addEventListener('click', toggleMobileMenu);
  if (closeMenuButton) closeMenuButton.addEventListener('click', toggleMobileMenu);

  document.addEventListener('click', (event) => {
    if (langButton && !langButton.contains(event.target) && langMenu && !langMenu.contains(event.target)) {
      langMenu.classList.add('hidden', 'opacity-0', 'scale-95');
      const arrowSvg = langButton.querySelector('svg:last-of-type'); if (arrowSvg) arrowSvg.classList.remove('rotate-180');
    }
    if (mobileLangButton && !mobileLangButton.contains(event.target) && mobileLangMenu && !mobileLangMenu.contains(event.target)) {
      mobileLangMenu.classList.add('hidden', 'opacity-0', 'scale-95');
      const arrowSvg = mobileLangButton.querySelector('svg:last-of-type'); if (arrowSvg) arrowSvg.classList.remove('rotate-180');
    }
  });
</script>
